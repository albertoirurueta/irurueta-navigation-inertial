<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>INSLooselyCoupledKalmanEpochEstimator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">com.irurueta:irurueta-navigation-inertial</a> &gt; <a href="index.source.html" class="el_package">com.irurueta.navigation.inertial</a> &gt; <span class="el_source">INSLooselyCoupledKalmanEpochEstimator.java</span></div><h1>INSLooselyCoupledKalmanEpochEstimator.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2019 Alberto Irurueta Carro (alberto@irurueta.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.irurueta.navigation.inertial;

import com.irurueta.algebra.AlgebraException;
import com.irurueta.algebra.Matrix;
import com.irurueta.algebra.Utils;
import com.irurueta.geometry.Point3D;
import com.irurueta.navigation.frames.ECEFPosition;
import com.irurueta.navigation.frames.ECEFVelocity;
import com.irurueta.navigation.frames.NEDPosition;
import com.irurueta.navigation.frames.NEDVelocity;
import com.irurueta.navigation.frames.converters.ECEFtoNEDPositionVelocityConverter;
import com.irurueta.navigation.geodesic.Constants;
import com.irurueta.navigation.gnss.ECEFPositionAndVelocity;
import com.irurueta.navigation.inertial.estimators.ECEFGravityEstimator;
import com.irurueta.units.Angle;
import com.irurueta.units.AngleConverter;
import com.irurueta.units.AngleUnit;
import com.irurueta.units.Time;
import com.irurueta.units.TimeConverter;
import com.irurueta.units.TimeUnit;

/**
 * Implements one cycle of the loosely coupled INS/GNSS
 * Kalman filter plus closed-loop correction of all inertial states.
 * This implementation is based on the equations defined in &quot;Principles of GNSS, Inertial, and Multisensor
 * Integrated Navigation Systems, Second Edition&quot; and on the companion software available at:
 * &lt;a href=&quot;https://github.com/ymjdz/MATLAB-Codes/blob/master/LC_KF_Epoch.m&quot;&gt;
 *     https://github.com/ymjdz/MATLAB-Codes/blob/master/LC_KF_Epoch.m
 * &lt;/a&gt;
 */
public class INSLooselyCoupledKalmanEpochEstimator {

    /**
     * Earth rotation rate expressed in radians per second (rad/s).
     */
    public static final double EARTH_ROTATION_RATE = Constants.EARTH_ROTATION_RATE;

    /**
     * The equatorial radius of WGS84 ellipsoid (6378137 m) defining Earth's shape.
     */
    public static final double EARTH_EQUATORIAL_RADIUS_WGS84 = Constants.EARTH_EQUATORIAL_RADIUS_WGS84;

    /**
     * Earth eccentricity as defined on the WGS84 ellipsoid.
     */
    public static final double EARTH_ECCENTRICITY = Constants.EARTH_ECCENTRICITY;

    /**
     * Number of components of position + velocity.
     */
    private static final int POS_AND_VEL_COMPONENTS = 6;

    /**
     * Constructor.
     * Prevents instantiation of helper class.
     */
    private INSLooselyCoupledKalmanEpochEstimator() {
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L92">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L93">        estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics, config, result);</span>
<span class="fc" id="L94">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L117">        final var fx = bodyKinematics.getFx();</span>
<span class="fc" id="L118">        final var fy = bodyKinematics.getFy();</span>
<span class="fc" id="L119">        final var fz = bodyKinematics.getFz();</span>

<span class="fc" id="L121">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz, config, result);</span>
<span class="fc" id="L122">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L142">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L143">        estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics, previousLatitude,</span>
                config, result);
<span class="fc" id="L145">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L169">        final var fx = bodyKinematics.getFx();</span>
<span class="fc" id="L170">        final var fy = bodyKinematics.getFy();</span>
<span class="fc" id="L171">        final var fz = bodyKinematics.getFz();</span>

<span class="fc" id="L173">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz, previousLatitude, config,</span>
                result);
<span class="fc" id="L175">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final INSLooselyCoupledKalmanConfig config)
            throws AlgebraException {
<span class="fc" id="L202">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L203">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz, config, result);</span>
<span class="fc" id="L204">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {

<span class="fc" id="L234">        final var x = userPosition.getX();</span>
<span class="fc" id="L235">        final var y = userPosition.getY();</span>
<span class="fc" id="L236">        final var z = userPosition.getZ();</span>

<span class="fc" id="L238">        final var vx = userVelocity.getVx();</span>
<span class="fc" id="L239">        final var vy = userVelocity.getVy();</span>
<span class="fc" id="L240">        final var vz = userVelocity.getVz();</span>

<span class="fc" id="L242">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, config, result);</span>
<span class="fc" id="L243">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L270">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L271">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz, previousLatitude, config,</span>
                result);
<span class="fc" id="L273">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        GNSS estimated ECEF user position.
     * @param userVelocity        GNSS estimated ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L304">        final var x = userPosition.getX();</span>
<span class="fc" id="L305">        final var y = userPosition.getY();</span>
<span class="fc" id="L306">        final var z = userPosition.getZ();</span>

<span class="fc" id="L308">        final var vx = userVelocity.getVx();</span>
<span class="fc" id="L309">        final var vy = userVelocity.getVy();</span>
<span class="fc" id="L310">        final var vz = userVelocity.getVz();</span>

<span class="fc" id="L312">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, previousLatitude, config, result);</span>
<span class="fc" id="L313">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L342">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L343">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, bodyKinematics, config, result);</span>
<span class="fc" id="L344">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L377">        final var fx = bodyKinematics.getFx();</span>
<span class="fc" id="L378">        final var fy = bodyKinematics.getFy();</span>
<span class="fc" id="L379">        final var fz = bodyKinematics.getFz();</span>

<span class="fc" id="L381">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, config, result);</span>
<span class="fc" id="L382">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L413">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L414">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, bodyKinematics, previousLatitude, config,</span>
                result);
<span class="fc" id="L416">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {

<span class="fc" id="L451">        final var fx = bodyKinematics.getFx();</span>
<span class="fc" id="L452">        final var fy = bodyKinematics.getFy();</span>
<span class="fc" id="L453">        final var fz = bodyKinematics.getFz();</span>

<span class="fc" id="L455">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, previousLatitude, config, result);</span>
<span class="fc" id="L456">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, double fy, final double fz, final INSLooselyCoupledKalmanConfig config)
            throws AlgebraException {
<span class="fc" id="L493">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L494">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, config, result);</span>
<span class="fc" id="L495">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L535">        final var prevNedPosition = new NEDPosition();</span>
<span class="fc" id="L536">        final var prevNedVelocity = new NEDVelocity();</span>
<span class="fc" id="L537">        ECEFtoNEDPositionVelocityConverter.convertECEFtoNED(</span>
<span class="fc" id="L538">                previousState.getX(), previousState.getY(), previousState.getZ(),</span>
<span class="fc" id="L539">                previousState.getVx(), previousState.getVy(), previousState.getVz(), prevNedPosition, prevNedVelocity);</span>

<span class="fc" id="L541">        final var previousLatitude = prevNedPosition.getLatitude();</span>

<span class="fc" id="L543">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, previousLatitude, config, result);</span>
<span class="fc" id="L544">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L582">        final var result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L583">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, previousLatitude, config, result);</span>
<span class="fc" id="L584">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {

<span class="fc" id="L626">        final var omegaIe = Utils.skewMatrix(new double[]{0.0, 0.0, EARTH_ROTATION_RATE});</span>

        // SYSTEM PROPAGATION PHASE

        // 1. Determine transition matrix using (14.50) (first-order approx)
<span class="fc" id="L631">        final var phiMatrix = Matrix.identity(</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS, INSLooselyCoupledKalmanState.NUM_PARAMS);

<span class="fc" id="L634">        final var tmp1 = omegaIe.multiplyByScalarAndReturnNew(propagationInterval);</span>
<span class="fc" id="L635">        final var tmp2 = phiMatrix.getSubmatrix(0, 0, 2, 2);</span>
<span class="fc" id="L636">        tmp2.subtract(tmp1);</span>

<span class="fc" id="L638">        phiMatrix.setSubmatrix(0, 0, 2, 2, tmp2);</span>

<span class="fc" id="L640">        final var estCbeOld = previousState.getBodyToEcefCoordinateTransformationMatrix();</span>
<span class="fc" id="L641">        tmp1.copyFrom(estCbeOld);</span>
<span class="fc" id="L642">        tmp1.multiplyByScalar(propagationInterval);</span>

<span class="fc" id="L644">        phiMatrix.setSubmatrix(0, 12, 2, 14, tmp1);</span>
<span class="fc" id="L645">        phiMatrix.setSubmatrix(3, 9, 5, 11, tmp1);</span>

<span class="fc" id="L647">        final var measFibb = new Matrix(BodyKinematics.COMPONENTS, 1);</span>
<span class="fc" id="L648">        measFibb.setElementAtIndex(0, fx);</span>
<span class="fc" id="L649">        measFibb.setElementAtIndex(1, fy);</span>
<span class="fc" id="L650">        measFibb.setElementAtIndex(2, fz);</span>

<span class="fc" id="L652">        estCbeOld.multiply(measFibb, tmp1);</span>

<span class="fc" id="L654">        Utils.skewMatrix(tmp1, tmp2);</span>
<span class="fc" id="L655">        tmp2.multiplyByScalar(-propagationInterval);</span>

<span class="fc" id="L657">        phiMatrix.setSubmatrix(3, 0, 5, 2, tmp2);</span>

<span class="fc" id="L659">        phiMatrix.getSubmatrix(3, 3, 5, 5, tmp1);</span>
<span class="fc" id="L660">        tmp2.copyFrom(omegaIe);</span>
<span class="fc" id="L661">        tmp2.multiplyByScalar(2.0 * propagationInterval);</span>
<span class="fc" id="L662">        tmp1.subtract(tmp2);</span>
<span class="fc" id="L663">        phiMatrix.setSubmatrix(3, 3, 5, 5, tmp1);</span>

<span class="fc" id="L665">        final var sinPrevLat = Math.sin(previousLatitude);</span>
<span class="fc" id="L666">        final var cosPrevLat = Math.cos(previousLatitude);</span>
<span class="fc" id="L667">        final var sinPrevLat2 = sinPrevLat * sinPrevLat;</span>
<span class="fc" id="L668">        final var cosPrevLat2 = cosPrevLat * cosPrevLat;</span>

        // From (2.137)
<span class="fc" id="L671">        final var geocentricRadius = EARTH_EQUATORIAL_RADIUS_WGS84</span>
<span class="fc" id="L672">                / Math.sqrt(1.0 - Math.pow(EARTH_ECCENTRICITY * sinPrevLat, 2.0)) * Math.sqrt(cosPrevLat2</span>
<span class="fc" id="L673">                + Math.pow(1.0 - EARTH_ECCENTRICITY * EARTH_ECCENTRICITY, 2.0) * sinPrevLat2);</span>

<span class="fc" id="L675">        final var prevX = previousState.getX();</span>
<span class="fc" id="L676">        final var prevY = previousState.getY();</span>
<span class="fc" id="L677">        final var prevZ = previousState.getZ();</span>
<span class="fc" id="L678">        final var gravity = ECEFGravityEstimator.estimateGravityAndReturnNew(prevX, prevY, prevZ);</span>

<span class="fc" id="L680">        final var previousPositionNorm = Math.sqrt(prevX * prevX + prevY * prevY + prevZ * prevZ);</span>

<span class="fc" id="L682">        final var estRebeOld = new Matrix(com.irurueta.navigation.frames.ECEFPosition.COMPONENTS, 1);</span>
<span class="fc" id="L683">        estRebeOld.setElementAtIndex(0, prevX);</span>
<span class="fc" id="L684">        estRebeOld.setElementAtIndex(1, prevY);</span>
<span class="fc" id="L685">        estRebeOld.setElementAtIndex(2, prevZ);</span>

<span class="fc" id="L687">        final var g = gravity.asMatrix();</span>
<span class="fc" id="L688">        g.multiplyByScalar(-2.0 * propagationInterval / geocentricRadius);</span>

<span class="fc" id="L690">        final var estRebeOldTrans = estRebeOld.transposeAndReturnNew();</span>
<span class="fc" id="L691">        estRebeOldTrans.multiplyByScalar(1.0 / previousPositionNorm);</span>

<span class="fc" id="L693">        g.multiply(estRebeOldTrans, tmp1);</span>

<span class="fc" id="L695">        phiMatrix.setSubmatrix(3, 6, 5, 8, tmp1);</span>

<span class="fc bfc" id="L697" title="All 2 branches covered.">        for (var i = 0; i &lt; com.irurueta.navigation.frames.ECEFPosition.COMPONENTS; i++) {</span>
<span class="fc" id="L698">            phiMatrix.setElementAt(6 + i, 3 + i, propagationInterval);</span>
        }

        // 2. Determine approximate system noise covariance matrix using (14.82)
<span class="fc" id="L702">        final var qPrimeMatrix = new Matrix(</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS,
                INSLooselyCoupledKalmanState.NUM_PARAMS);

<span class="fc" id="L706">        final var gyroNoisePSD = config.getGyroNoisePSD();</span>
<span class="fc" id="L707">        final var gyroNoiseValue = gyroNoisePSD * propagationInterval;</span>
<span class="fc bfc" id="L708" title="All 2 branches covered.">        for (var i = 0; i &lt; 3; i++) {</span>
<span class="fc" id="L709">            qPrimeMatrix.setElementAt(i, i, gyroNoiseValue);</span>
        }

<span class="fc" id="L712">        final var accelNoisePSD = config.getAccelerometerNoisePSD();</span>
<span class="fc" id="L713">        final var accelNoiseValue = accelNoisePSD * propagationInterval;</span>
<span class="fc bfc" id="L714" title="All 2 branches covered.">        for (var i = 3; i &lt; 6; i++) {</span>
<span class="fc" id="L715">            qPrimeMatrix.setElementAt(i, i, accelNoiseValue);</span>
        }

<span class="fc" id="L718">        final var accelBiasPSD = config.getAccelerometerBiasPSD();</span>
<span class="fc" id="L719">        final var accelBiasValue = accelBiasPSD * propagationInterval;</span>
<span class="fc bfc" id="L720" title="All 2 branches covered.">        for (var i = 9; i &lt; 12; i++) {</span>
<span class="fc" id="L721">            qPrimeMatrix.setElementAt(i, i, accelBiasValue);</span>
        }

<span class="fc" id="L724">        final var gyroBiasPSD = config.getGyroBiasPSD();</span>
<span class="fc" id="L725">        final var gyroBiasValue = gyroBiasPSD * propagationInterval;</span>
<span class="fc bfc" id="L726" title="All 2 branches covered.">        for (var i = 12; i &lt; 15; i++) {</span>
<span class="fc" id="L727">            qPrimeMatrix.setElementAt(i, i, gyroBiasValue);</span>
        }

        // 3. Propagate state estimates using (3.14) noting that all states are zero
        // due to closed-loop correction.
        // x_est_propagated(1:15, 1) = 0

        // 4. Propagate state estimation error covariance matrix using (3.46)
<span class="fc" id="L735">        final var pMatrixOld = previousState.getCovariance();</span>

<span class="fc" id="L737">        qPrimeMatrix.multiplyByScalar(0.5);</span>

<span class="fc" id="L739">        final var tmp3 = pMatrixOld.addAndReturnNew(qPrimeMatrix);</span>
<span class="fc" id="L740">        final var pMatrixPropagated = phiMatrix.multiplyAndReturnNew(tmp3);</span>

<span class="fc" id="L742">        phiMatrix.transpose();</span>
<span class="fc" id="L743">        pMatrixPropagated.multiply(phiMatrix);</span>

<span class="fc" id="L745">        pMatrixPropagated.add(qPrimeMatrix);</span>

        // MEASUREMENT UPDATE PHASE

        // 5. Set-up measurement matrix using (14.115)
<span class="fc" id="L750">        final var h = new Matrix(POS_AND_VEL_COMPONENTS, INSLooselyCoupledKalmanState.NUM_PARAMS);</span>
<span class="fc bfc" id="L751" title="All 2 branches covered.">        for (var i = 0; i &lt; 3; i++) {</span>
<span class="fc" id="L752">            h.setElementAt(i, POS_AND_VEL_COMPONENTS + i, -1.0);</span>
<span class="fc" id="L753">            final var j = ECEFPosition.COMPONENTS + i;</span>
<span class="fc" id="L754">            h.setElementAt(j, j, -1.0);</span>
        }

        // 6. Set-up measurement noise covariance matrix assuming all components of
        // GNSS position and velocity are independent and have equal variance.
<span class="fc" id="L759">        final var r = new Matrix(POS_AND_VEL_COMPONENTS, POS_AND_VEL_COMPONENTS);</span>

<span class="fc" id="L761">        final var posMeasSD = config.getPositionNoiseSD();</span>
<span class="fc" id="L762">        final var posMeasSD2 = posMeasSD * posMeasSD;</span>
<span class="fc bfc" id="L763" title="All 2 branches covered.">        for (var i = 0; i &lt; com.irurueta.navigation.frames.ECEFPosition.COMPONENTS; i++) {</span>
<span class="fc" id="L764">            r.setElementAt(i, i, posMeasSD2);</span>
        }

<span class="fc" id="L767">        final var velMeasSD = config.getVelocityNoiseSD();</span>
<span class="fc" id="L768">        final var velMeasSD2 = velMeasSD * velMeasSD;</span>
<span class="fc bfc" id="L769" title="All 2 branches covered.">        for (var i = com.irurueta.navigation.frames.ECEFPosition.COMPONENTS; i &lt; POS_AND_VEL_COMPONENTS; i++) {</span>
<span class="fc" id="L770">            r.setElementAt(i, i, velMeasSD2);</span>
        }

        // 7. Calculate Kalman gain using (3.21)
<span class="fc" id="L774">        final var hTrans = h.transposeAndReturnNew();</span>

<span class="fc" id="L776">        final var tmp4 = h.multiplyAndReturnNew(pMatrixPropagated);</span>
<span class="fc" id="L777">        tmp4.multiply(hTrans);</span>
<span class="fc" id="L778">        tmp4.add(r);</span>

<span class="fc" id="L780">        final var tmp5 = Utils.inverse(tmp4);</span>

<span class="fc" id="L782">        final var k = pMatrixPropagated.multiplyAndReturnNew(hTrans);</span>
<span class="fc" id="L783">        k.multiply(tmp5);</span>

        // 8. Formulate measurement innovations using (14.102), noting that zero
        // lever arm is assumed here
<span class="fc" id="L787">        final var prevVx = previousState.getVx();</span>
<span class="fc" id="L788">        final var prevVy = previousState.getVy();</span>
<span class="fc" id="L789">        final var prevVz = previousState.getVz();</span>

<span class="fc" id="L791">        final var deltaZ = new Matrix(POS_AND_VEL_COMPONENTS, 1);</span>
<span class="fc" id="L792">        deltaZ.setElementAtIndex(0, x - prevX);</span>
<span class="fc" id="L793">        deltaZ.setElementAtIndex(1, y - prevY);</span>
<span class="fc" id="L794">        deltaZ.setElementAtIndex(2, z - prevZ);</span>
<span class="fc" id="L795">        deltaZ.setElementAtIndex(3, vx - prevVx);</span>
<span class="fc" id="L796">        deltaZ.setElementAtIndex(4, vy - prevVy);</span>
<span class="fc" id="L797">        deltaZ.setElementAtIndex(5, vz - prevVz);</span>

        // 9. Update state estimates using (3.24)
        // x_est_new = x_est_propagated + K_matrix * delta_z
<span class="fc" id="L801">        final var xEstNew = k.multiplyAndReturnNew(deltaZ);</span>

        // 10. Update state estimation error covariance matrix using (3.25)
<span class="fc" id="L804">        k.multiply(h);</span>
<span class="fc" id="L805">        final var pNew = Matrix.identity(INSLooselyCoupledKalmanState.NUM_PARAMS,</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS);
<span class="fc" id="L807">        pNew.subtract(k);</span>
<span class="fc" id="L808">        pNew.multiply(pMatrixPropagated);</span>

        // CLOSED-LOOP CORRECTION

        // Correct attitude, velocity, and position using (14.7-9)
<span class="fc" id="L813">        final var tmp6 = xEstNew.getSubmatrix(0, 0, 2, 0);</span>
<span class="fc" id="L814">        final var tmp7 = Utils.skewMatrix(tmp6);</span>

<span class="fc" id="L816">        final var estCbeNew = Matrix.identity(ECEFPosition.COMPONENTS, ECEFPosition.COMPONENTS);</span>
<span class="fc" id="L817">        estCbeNew.subtract(tmp7);</span>
<span class="fc" id="L818">        estCbeNew.multiply(estCbeOld);</span>

<span class="fc" id="L820">        final var newVx = prevVx - xEstNew.getElementAtIndex(3);</span>
<span class="fc" id="L821">        final var newVy = prevVy - xEstNew.getElementAtIndex(4);</span>
<span class="fc" id="L822">        final var newVz = prevVz - xEstNew.getElementAtIndex(5);</span>

<span class="fc" id="L824">        final var newX = prevX - xEstNew.getElementAtIndex(6);</span>
<span class="fc" id="L825">        final var newY = prevY - xEstNew.getElementAtIndex(7);</span>
<span class="fc" id="L826">        final var newZ = prevZ - xEstNew.getElementAtIndex(8);</span>

        // Update IMU bias estimates
<span class="fc" id="L829">        final var newAccelerationBiasX = previousState.getAccelerationBiasX() + xEstNew.getElementAtIndex(9);</span>
<span class="fc" id="L830">        final var newAccelerationBiasY = previousState.getAccelerationBiasY() + xEstNew.getElementAtIndex(10);</span>
<span class="fc" id="L831">        final var newAccelerationBiasZ = previousState.getAccelerationBiasZ() + xEstNew.getElementAtIndex(11);</span>

<span class="fc" id="L833">        final var newGyroBiasX = previousState.getGyroBiasX() + xEstNew.getElementAtIndex(12);</span>
<span class="fc" id="L834">        final var newGyroBiasY = previousState.getGyroBiasY() + xEstNew.getElementAtIndex(13);</span>
<span class="fc" id="L835">        final var newGyroBiasZ = previousState.getGyroBiasZ() + xEstNew.getElementAtIndex(14);</span>

        // set result values
<span class="fc" id="L838">        result.setBodyToEcefCoordinateTransformationMatrix(estCbeNew);</span>
<span class="fc" id="L839">        result.setVelocityCoordinates(newVx, newVy, newVz);</span>
<span class="fc" id="L840">        result.setPositionCoordinates(newX, newY, newZ);</span>
<span class="fc" id="L841">        result.setAccelerationBiasCoordinates(newAccelerationBiasX, newAccelerationBiasY, newAccelerationBiasZ);</span>
<span class="fc" id="L842">        result.setGyroBiasCoordinates(newGyroBiasX, newGyroBiasY, newGyroBiasZ);</span>
<span class="fc" id="L843">        result.setCovariance(pNew);</span>
<span class="fc" id="L844">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L863">        return estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, bodyKinematics,</span>
                config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L886">        estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, bodyKinematics, config,</span>
                result);
<span class="fc" id="L888">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L908">        return estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, bodyKinematics,</span>
                previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L932">        estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, bodyKinematics,</span>
                previousLatitude, config, result);
<span class="fc" id="L934">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L960">        return estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, fx, fy, fz,</span>
                config);
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L990">        estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, fx, fy, fz, config,</span>
                result);
<span class="fc" id="L992">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1019">        return estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, fx, fy, fz,</span>
                previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1050">        estimate(userPosition, userVelocity, convertTime(propagationInterval), previousState, fx, fy, fz,</span>
                previousLatitude, config, result);
<span class="fc" id="L1052">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1081">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, bodyKinematics, config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1113">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, bodyKinematics, config, result);</span>
<span class="fc" id="L1114">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1145">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, bodyKinematics,</span>
                previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L1180">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, bodyKinematics, previousLatitude,</span>
                config, result);
<span class="fc" id="L1182">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final INSLooselyCoupledKalmanConfig config)
            throws AlgebraException {
<span class="fc" id="L1219">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, fx, fy, fz, config);</span>
    }

    /**
     * Estimated the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1258">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, fx, fy, fz, config, result);</span>
<span class="fc" id="L1259">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1297">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, fx, fy, fz,</span>
                previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L1339">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState, fx, fy, fz, previousLatitude,</span>
                config, result);
<span class="fc" id="L1341">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEf user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1360">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1361">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L1384">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1385">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, config, result);
<span class="fc" id="L1387">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1407">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1408">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval,</span>
                previousState, bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1432">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1433">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L1435">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1461">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1462">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1492">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1493">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L1495">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1522">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1523">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1554">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1555">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1557">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1576">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1577">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1600">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1601">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, config, result);
<span class="fc" id="L1603">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1624">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1625">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1649">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1650">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L1652">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1678">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1679">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L1709">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1710">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L1712">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1739">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1740">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1771">        estimate(userPosition.getInhomX(), userPosition.getInhomY(), userPosition.getInhomZ(),</span>
<span class="fc" id="L1772">                userVelocity.getVx(), userVelocity.getVy(), userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1774">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1792">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1793">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L1815">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1816">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, config, result);
<span class="fc" id="L1818">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1837">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1838">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1861">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1862">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L1864">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1889">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1890">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L1918">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1919">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config, result);
<span class="fc" id="L1921">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1947">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1948">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1978">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L1979">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1981">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1999">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2000">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2022">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2023">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, config, result);
<span class="fc" id="L2025">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2044">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2045">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2068">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2069">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L2071">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2096">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2097">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2126">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2127">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config, result);
<span class="fc" id="L2129">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2155">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2156">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final double previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2186">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(), positionAndVelocity.getZ(),</span>
<span class="fc" id="L2187">                positionAndVelocity.getVx(), positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L2189">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2209">        return estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2210">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2234">        estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2235">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2236">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2264">        return estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2265">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        GNSS estimated ECEF user position.
     * @param userVelocity        GNSS estimated ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2296">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2297">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2298">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2329">        return estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2330">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2364">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2365">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2366">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2404">        return estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2405">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final double propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2446">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, convertAngle(previousLatitude),</span>
                config, result);
<span class="fc" id="L2448">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2468">        return estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2469">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2493">        estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2494">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2495">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2522">        return estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2523">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2553">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2554">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2555">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2586">        return estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2587">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2621">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2622">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2623">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2661">        return estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2662">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z, final double vx, final double vy, final double vz,
            final Time propagationInterval, final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz, final Angle previousLatitude,
            final INSLooselyCoupledKalmanConfig config, final INSLooselyCoupledKalmanState result)
            throws AlgebraException {
<span class="fc" id="L2703">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState, fx, fy, fz, convertAngle(previousLatitude),</span>
                config, result);
<span class="fc" id="L2705">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2725">        return estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2726">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2749">        estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2750">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2751">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2778">        return estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2779">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2809">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2810">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2811">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2831">        return estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2832">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2855">        estimate(userPosition, userVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2856">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2857">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2884">        return estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2885">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition, final ECEFVelocity userVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2915">        estimate(userPosition, userVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2916">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2917">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2936">        return estimate(positionAndVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2937">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2959">        estimate(positionAndVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L2960">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L2961">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2987">        return estimate(positionAndVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L2988">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L3017">        estimate(positionAndVelocity, propagationInterval, previousState, fx, fy, fz, convertAngle(previousLatitude),</span>
                config, result);
<span class="fc" id="L3019">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L3038">        return estimate(positionAndVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L3039">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final BodyKinematics bodyKinematics,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L3061">        estimate(positionAndVelocity, propagationInterval, previousState, bodyKinematics,</span>
<span class="fc" id="L3062">                convertAngle(previousLatitude), config, result);</span>
<span class="fc" id="L3063">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L3089">        return estimate(positionAndVelocity, propagationInterval, previousState, fx, fy, fz,</span>
<span class="fc" id="L3090">                convertAngle(previousLatitude), config);</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity, final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState, final double fx, final double fy, final double fz,
            final Angle previousLatitude, final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L3119">        estimate(positionAndVelocity, propagationInterval, previousState, fx, fy, fz, convertAngle(previousLatitude),</span>
                config, result);
<span class="fc" id="L3121">    }</span>

    /**
     * Converts time instance into a value expressed in seconds.
     *
     * @param time time instance to be converted.
     * @return time value expressed in seconds.
     */
    private static double convertTime(final Time time) {
<span class="fc" id="L3130">        return TimeConverter.convert(time.getValue().doubleValue(), time.getUnit(), TimeUnit.SECOND);</span>
    }

    /**
     * Converts angle instance into a value expressed in radians.
     *
     * @param angle angle instance to be converted.
     * @return angle value expressed in radians.
     */
    private static double convertAngle(final Angle angle) {
<span class="fc" id="L3140">        return AngleConverter.convert(angle.getValue().doubleValue(), angle.getUnit(), AngleUnit.RADIANS);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>